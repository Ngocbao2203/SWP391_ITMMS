# üöÄ ITMMS API Services - H∆∞·ªõng D·∫´n S·ª≠ D·ª•ng

## üìã T·ªïng Quan

B·ªô API Services ho√†n ch·ªânh cho h·ªá th·ªëng ITMMS (Infertility Treatment Management Medical System) v·ªõi c√°c t√≠nh nƒÉng:

- ‚úÖ **8 Services ch√≠nh** cho t·∫•t c·∫£ modules
- ‚úÖ **Error handling** th·ªëng nh·∫•t 
- ‚úÖ **Type safety** v√† validation
- ‚úÖ **Utility functions** h·ªó tr·ª£
- ‚úÖ **Clean architecture** d·ªÖ maintain
- ‚úÖ **Documentation** ƒë·∫ßy ƒë·ªß

## üèóÔ∏è C·∫•u Tr√∫c Services

```
src/services/
‚îú‚îÄ‚îÄ api.js                 # Base HTTP client
‚îú‚îÄ‚îÄ apiConstants.js        # API endpoints & constants
‚îú‚îÄ‚îÄ authService.js         # Authentication & user management
‚îú‚îÄ‚îÄ appointmentService.js  # Appointment booking & management
‚îú‚îÄ‚îÄ doctorService.js       # Doctor profiles & schedules
‚îú‚îÄ‚îÄ patientService.js      # Patient data & medical history
‚îú‚îÄ‚îÄ treatmentService.js    # Treatment services & plans
‚îú‚îÄ‚îÄ guestService.js        # Public/guest APIs
‚îú‚îÄ‚îÄ adminService.js        # Admin dashboard & management
‚îú‚îÄ‚îÄ index.js              # Export all services + utilities
‚îî‚îÄ‚îÄ README.md             # This file
```

## üöÄ Quick Start

### 1. C·∫•u H√¨nh Environment

T·∫°o file `.env` trong root project:

```env
REACT_APP_API_URL=http://localhost:5037
```

### 2. Import Services

```javascript
// Import t·∫•t c·∫£ services
import {
  authService,
  appointmentService,
  doctorService,
  patientService,
  treatmentService,
  guestService,
  adminService,
  apiServiceFacade
} from './services';

// Ho·∫∑c import facade ƒë·ªÉ d√πng nhanh
import apiServices from './services';
```

### 3. S·ª≠ D·ª•ng C∆° B·∫£n

```javascript
// Login nhanh
const result = await apiServices.login('user@example.com', '123456');

// ƒê·∫∑t l·ªãch h·∫πn
const appointment = await apiServices.bookAppointment({
  doctorId: 1,
  appointmentDate: '2025-01-15T10:00:00',
  timeSlot: '10:00-11:00',
  type: 'Consultation'
});

// L·∫•y dashboard data
const dashboardData = await apiServices.getPatientDashboard(customerId);
```

## üîê Authentication Service

### Login & Registration

```javascript
import { authService } from './services';

// ƒêƒÉng nh·∫≠p
const loginResult = await authService.login({
  email: 'user@example.com',
  password: '123456'
});

if (loginResult.success) {
  console.log('User:', loginResult.user);
  // User ƒë∆∞·ª£c t·ª± ƒë·ªông l∆∞u v√†o localStorage
}

// ƒêƒÉng k√Ω
const registerResult = await authService.register({
  fullName: 'Nguyen Van A',
  email: 'user@example.com',
  phone: '0123456789',
  address: '123 Main Street',
  username: 'username',
  password: '123456',
  confirmPassword: '123456',
  role: 'Customer'
});
```

### User Management

```javascript
// Ki·ªÉm tra authentication
if (authService.isAuthenticated()) {
  const currentUser = authService.getCurrentUser();
  console.log('Current user:', currentUser);
}

// Ki·ªÉm tra role
if (authService.hasRole('Doctor')) {
  // Show doctor features
}

if (authService.hasRole(['Admin', 'Manager'])) {
  // Show admin features
}

// C·∫≠p nh·∫≠t profile
const updateResult = await authService.updateProfile(userId, {
  fullName: 'Nguyen Van B',
  phone: '0987654321'
});

// ƒê·ªïi m·∫≠t kh·∫©u
const changePasswordResult = await authService.changePassword({
  userId: 1,
  oldPassword: '123456',
  newPassword: 'newpassword123'
});
```

## üìÖ Appointment Service

### ƒê·∫∑t L·ªãch H·∫πn

```javascript
import { appointmentService } from './services';

// ƒê·∫∑t l·ªãch h·∫πn m·ªõi
const bookingResult = await appointmentService.bookAppointment({
  doctorId: 1,
  treatmentPlanId: null, // Optional
  appointmentDate: '2025-01-15T10:00:00',
  timeSlot: '10:00-11:00',
  type: 'Consultation',
  notes: 'First consultation'
});

// Ki·ªÉm tra time slot available
const availability = await appointmentService.checkTimeSlotAvailability(
  doctorId, 
  '2025-01-15T10:00:00', 
  '10:00-11:00'
);

if (availability.available) {
  // Proceed with booking
}
```

### Qu·∫£n L√Ω L·ªãch H·∫πn

```javascript
// L·∫•y l·ªãch h·∫πn c·ªßa customer
const customerAppointments = await appointmentService.getCustomerAppointments(customerId, {
  status: 'Scheduled,Confirmed',
  sort: 'appointmentDate',
  order: 'asc'
});

// L·∫•y l·ªãch h·∫πn s·∫Øp t·ªõi
const upcomingAppointments = await appointmentService.getUpcomingAppointments(customerId, 7);

// C·∫≠p nh·∫≠t l·ªãch h·∫πn
const updateResult = await appointmentService.updateAppointment(appointmentId, {
  notes: 'Updated notes',
  timeSlot: '11:00-12:00'
});

// H·ªßy l·ªãch h·∫πn
const cancelResult = await appointmentService.cancelAppointment(appointmentId);
```

## üë®‚Äç‚öïÔ∏è Doctor Service

### T√¨m Ki·∫øm B√°c Sƒ©

```javascript
import { doctorService } from './services';

// L·∫•y t·∫•t c·∫£ b√°c sƒ©
const allDoctors = await doctorService.getAllDoctors();

// T√¨m ki·∫øm b√°c sƒ©
const searchResults = await doctorService.searchDoctors({
  specialization: 'Fertility Specialist',
  available: true
});

// L·∫•y top rated doctors
const topDoctors = await doctorService.getTopRatedDoctors(5);

// L·∫•y b√°c sƒ© available
const availableDoctors = await doctorService.getAvailableDoctors();
```

### Qu·∫£n L√Ω B√°c Sƒ©

```javascript
// L·∫•y chi ti·∫øt b√°c sƒ©
const doctorDetails = await doctorService.getDoctorDetails(doctorId);

// L·∫•y feedback c·ªßa b√°c sƒ©
const doctorFeedback = await doctorService.getDoctorFeedback(doctorId);

// L·∫•y l·ªãch l√†m vi·ªác
const doctorSchedule = await doctorService.getDoctorSchedule(
  doctorId, 
  '2025-01-01', 
  '2025-01-31'
);

// L·∫•y time slots available
const availableSlots = await doctorService.getAvailableTimeSlots(
  doctorId, 
  '2025-01-15',
  ['09:00', '17:00'], // Working hours
  60 // Slot duration in minutes
);
```

## üè• Patient Service

### Dashboard & Overview

```javascript
import { patientService } from './services';

// L·∫•y dashboard data ho√†n ch·ªânh
const dashboard = await patientService.getPatientDashboard(customerId);
console.log('Dashboard:', {
  upcomingAppointments: dashboard.upcomingAppointments,
  activeTreatmentPlans: dashboard.activeTreatmentPlans,
  recentTestResults: dashboard.recentTestResults,
  unreadNotifications: dashboard.unreadNotifications
});

// L·∫•y medical summary
const medicalSummary = await patientService.getMedicalSummary(customerId);
```

### Medical Data

```javascript
// L·∫•y medical history
const medicalHistory = await patientService.getPatientMedicalHistory(customerId);

// L·∫•y test results
const testResults = await patientService.getPatientTestResults(customerId);

// L·∫•y treatment plans
const treatmentPlans = await patientService.getPatientTreatmentPlans(customerId);

// T√¨m ki·∫øm trong medical records
const searchResults = await patientService.searchMedicalRecords(
  customerId, 
  'hi·∫øm mu·ªôn'
);
```

### Notifications

```javascript
// L·∫•y notifications
const notifications = await patientService.getPatientNotifications(userId);

// ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc
await patientService.markNotificationAsRead(notificationId);

// L·∫•y s·ªë l∆∞·ª£ng ch∆∞a ƒë·ªçc
const unreadCount = await patientService.getUnreadNotificationsCount(userId);
```

## ü©∫ Treatment Service

### Treatment Services

```javascript
import { treatmentService } from './services';

// L·∫•y t·∫•t c·∫£ d·ªãch v·ª• ƒëi·ªÅu tr·ªã
const allServices = await treatmentService.getAllTreatmentServices();

// T√¨m ki·∫øm d·ªãch v·ª•
const searchResults = await treatmentService.searchTreatmentServices({
  keyword: 'IVF',
  minPrice: 10000000,
  maxPrice: 100000000
});

// L·∫•y pricing information
const pricing = await treatmentService.getPublicPricing();
```

### Treatment Plans

```javascript
// T·∫°o treatment plan
const planResult = await treatmentService.createTreatmentPlan({
  customerId: 1,
  doctorId: 1,
  treatmentServiceId: 1,
  treatmentType: 'IVF',
  description: 'K·∫ø ho·∫°ch ƒëi·ªÅu tr·ªã IVF',
  startDate: '2025-01-20T00:00:00',
  totalCost: 85000000,
  notes: 'B·ªánh nh√¢n kh·ªèe m·∫°nh, ti√™n l∆∞·ª£ng t·ªët'
});

// C·∫≠p nh·∫≠t ti·∫øn tr√¨nh ƒëi·ªÅu tr·ªã
const progressResult = await treatmentService.updateTreatmentProgress(planId, {
  currentPhase: 2,
  phaseDescription: 'Giai ƒëo·∫°n k√≠ch th√≠ch bu·ªìng tr·ª©ng',
  nextPhaseDate: '2025-01-25T00:00:00',
  progressNotes: 'Ph·∫£n ·ª©ng t·ªët v·ªõi thu·ªëc k√≠ch th√≠ch'
});

// Ho√†n th√†nh treatment plan
const completeResult = await treatmentService.completeTreatmentPlan(planId, {
  outcome: 'Successful',
  finalNotes: 'ƒêi·ªÅu tr·ªã th√†nh c√¥ng'
});
```

## üåê Guest Service (Public APIs)

### Trang Ch·ªß & Th√¥ng Tin C√¥ng Khai

```javascript
import { guestService } from './services';

// L·∫•y th√¥ng tin trang ch·ªß
const homeData = await guestService.getHomePageInfo();
console.log('Clinic info:', homeData.clinicInfo);
console.log('Stats:', homeData.stats);
console.log('Featured services:', homeData.featuredServices);

// L·∫•y d·ªãch v·ª• c√¥ng khai
const publicServices = await guestService.getPublicServices();

// L·∫•y b√°c sƒ© c√¥ng khai
const publicDoctors = await guestService.getPublicDoctors();
```

### T√¨m Ki·∫øm & Blog

```javascript
// T√¨m ki·∫øm to√†n c·ª•c
const searchResults = await guestService.globalSearch({
  query: 'IVF',
  type: 'service'
});

// L·∫•y blog posts
const blogPosts = await guestService.getBlogPosts({
  page: 1,
  pageSize: 10
});

// L·∫•y categories
const categories = await guestService.getBlogCategories();
```

## üëë Admin Service (Dashboard & Management)

### Dashboard Statistics

```javascript
import { adminService } from './services';

// L·∫•y dashboard stats c∆° b·∫£n
const dashboardStats = await adminService.getDashboardStats();

// L·∫•y dashboard ho√†n ch·ªânh
const completeDashboard = await adminService.getCompleteDashboard();

// L·∫•y monthly report
const monthlyReport = await adminService.getMonthlyReport(1, 2025);

// L·∫•y analytics data
const analyticsData = await adminService.getAnalyticsData('month');
```

### Medical Management

```javascript
// Ho√†n th√†nh appointment (Doctor)
const completeResult = await adminService.completeAppointment(doctorId, {
  appointmentId: 1,
  symptoms: 'Hi·∫øm mu·ªôn, kh√≥ th·ª• thai',
  diagnosis: 'Hi·∫øm mu·ªôn nguy√™n ph√°t',
  treatment: 'K√≠ch th√≠ch bu·ªìng tr·ª©ng',
  prescription: 'Clomiphene citrate 50mg',
  notes: 'T√°i kh√°m sau 1 th√°ng',
  followUpRequired: true,
  nextAppointmentDate: '2025-02-15T10:00:00'
});

// T·∫°o test result
const testResult = await adminService.createTestResult({
  customerId: 1,
  doctorId: 1,
  testName: 'X√©t nghi·ªám m√°u',
  testType: 'Blood Test',
  testDate: '2025-01-20T10:00:00',
  results: 'B√¨nh th∆∞·ªùng',
  normalRange: '5-10',
  status: 'Completed',
  notes: 'K·∫øt qu·∫£ t·ªët'
});
```

## üõ†Ô∏è Utility Functions

### Error Handling

```javascript
import { 
  formatErrorMessage, 
  handleApiCall,
  ApiError 
} from './services';

// Format error messages
try {
  await authService.login({ email: 'invalid', password: '123' });
} catch (error) {
  const message = formatErrorMessage(error);
  console.log('Error:', message);
  
  // Check error types
  if (error.isValidationError()) {
    const validationErrors = error.getValidationErrors();
    console.log('Validation errors:', validationErrors);
  }
}

// Handle API calls with notifications
const result = await handleApiCall(
  authService.login({ email: 'user@example.com', password: '123456' }),
  { 
    showSuccess: true, 
    showError: true,
    defaultMessage: 'ƒêƒÉng nh·∫≠p th√†nh c√¥ng!'
  }
);
```

### Formatting & Validation

```javascript
import {
  formatDateForDisplay,
  formatDateForApi,
  formatCurrency,
  isValidEmail,
  isValidPhone,
  debounce
} from './services';

// Format functions
const displayDate = formatDateForDisplay('2025-01-15T10:00:00'); // "15/01/2025"
const apiDate = formatDateForApi(new Date()); // "2025-01-15T10:00:00.000Z"
const currency = formatCurrency(85000000); // "85.000.000 ‚Ç´"

// Validation
const emailValid = isValidEmail('user@example.com'); // true
const phoneValid = isValidPhone('0123456789'); // true

// Debounced search
const debouncedSearch = debounce(async (query) => {
  const results = await guestService.globalSearch({ query });
  console.log('Search results:', results);
}, 300);
```

## üéØ Best Practices

### 1. Error Handling

```javascript
// ‚úÖ Lu√¥n handle errors
try {
  const result = await authService.login(credentials);
  if (result.success) {
    // Handle success
  } else {
    // Handle failure
    console.error(result.message);
  }
} catch (error) {
  // Handle network/unexpected errors
  console.error(formatErrorMessage(error));
}
```

### 2. Loading States

```javascript
// ‚úÖ Manage loading states
const [loading, setLoading] = useState(false);

const handleLogin = async () => {
  setLoading(true);
  try {
    const result = await authService.login(credentials);
    // Handle result
  } catch (error) {
    // Handle error
  } finally {
    setLoading(false);
  }
};
```

### 3. Data Caching

```javascript
// ‚úÖ Cache frequently used data
const [doctors, setDoctors] = useState(null);

useEffect(() => {
  if (!doctors) {
    doctorService.getAllDoctors().then(setDoctors);
  }
}, [doctors]);
```

### 4. Pagination

```javascript
// ‚úÖ Handle pagination properly
const [appointments, setAppointments] = useState([]);
const [page, setPage] = useState(1);

const loadAppointments = async (pageNum) => {
  const result = await appointmentService.getCustomerAppointments(customerId, {
    page: pageNum,
    pageSize: 10
  });
  setAppointments(result.appointments);
};
```

## üîß Configuration

### Environment Variables

```env
# API Configuration
REACT_APP_API_URL=http://localhost:5037

# Optional: Enable debug mode
REACT_APP_DEBUG_API=true

# Optional: API timeout
REACT_APP_API_TIMEOUT=10000
```

### Global Setup

```javascript
// src/index.js ho·∫∑c App.js
import { setGlobalErrorHandler } from './services';

// Setup global error handler
setGlobalErrorHandler((error) => {
  console.error('Global API Error:', error);
  // Show notification or redirect to error page
});
```

## üìû API Testing

### Test All Connections

```javascript
import {
  authService,
  appointmentService,
  doctorService,
  treatmentService,
  adminService
} from './services';

// Test t·∫•t c·∫£ API connections
const testConnections = async () => {
  try {
    await Promise.all([
      authService.testConnection(),
      appointmentService.testConnection(),
      doctorService.testConnection(),
      treatmentService.testConnection(),
      adminService.testConnection()
    ]);
    console.log('‚úÖ All API connections working!');
  } catch (error) {
    console.error('‚ùå API connection failed:', error);
  }
};
```

## üéâ K·∫øt Lu·∫≠n

B·ªô API Services n√†y cung c·∫•p:

- **Complete coverage** cho t·∫•t c·∫£ ch·ª©c nƒÉng ITMMS
- **Type-safe** operations v·ªõi error handling
- **Easy-to-use** interface v·ªõi clear documentation
- **Scalable architecture** cho future expansion
- **Production-ready** v·ªõi best practices

Ch·ªâ c·∫ßn import v√† s·ª≠ d·ª•ng! üöÄ

---

**Happy Coding!** üíª‚ú®

N·∫øu c√≥ v·∫•n ƒë·ªÅ ho·∫∑c c·∫ßn h·ªó tr·ª£, vui l√≤ng t·∫°o issue ho·∫∑c li√™n h·ªá team development. 